{% extends 'base.html' %}

{% block title %}Inventario{% endblock %}

{% block content %}

<div class="inventario-main">
    <h3 class="inventario-title">Gestión de Inventario</h3>
    <button class="inventario-btn inventario-btn-add" id="btnAbrirAgregar">Agregar Productos</button>
    <table class="inventario-table">
        <thead>
            <tr>
                <th>Imagen</th>
                <th>Nombre</th>
                <th>Descripción</th>
                <th>Precio</th>
                <th>Cantidad</th>
                <th>Acciones</th>
            </tr>
        </thead>
        <tbody>
            {% for p in productos %}
            <tr>
                <td><img src="{{ url_for('static', filename='uploads/' + p.imagen) }}" width="80" style="border-radius:6px;box-shadow:0 1px 6px #0001;"></td>
                <td>{{ p.nombre_producto }}</td>
                <td>{{ p.descripcion }}</td>
                <td>${{ "{:,.0f}".format (p.precio) }}</td>
                <td>{{ p.cantidad }}</td>
                <td>
                    <button class="inventario-btn inventario-btn-edit" data-modal="ModalEdit{{ p['idProducto'] }}">Editar</button>
                    <button class="inventario-btn inventario-btn-delete" data-modal="ModalEliminar{{ p['idProducto'] }}">Eliminar</button>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>


    <!-- Modal Agregar Producto -->
    <div class="inventario-modal" id="modalAgregar" style="display:none;">
        <div class="inventario-modal-backdrop" data-close="modalAgregar"></div>
        <div class="inventario-modal-content">
            <div class="inventario-modal-header">
                <h4>Agregar Producto</h4>
                <button type="button" class="inventario-modal-close" data-close="modalAgregar">&times;</button>
            </div>
            <form method="POST" action="{{ url_for('agregar_producto') }}" enctype="multipart/form-data" class="inventario-modal-form">
                <div class="inventario-modal-group">
                    <label for="nombre">Nombre del Producto</label>
                    <input type="text" id="nombre" name="nombre" required>
                </div>
                <div class="inventario-modal-group">
                    <label for="precio">Precio</label>
                    <input type="number" id="precio" name="precio" required>
                </div>
                <div class="inventario-modal-group">
                    <label for="descripcion">Descripción</label>
                    <textarea id="descripcion" name="descripcion" rows="3"></textarea>
                </div>
                <div class="inventario-modal-group">
                    <label for="cantidad">Cantidad</label>
                    <input type="number" id="cantidad" name="cantidad" required>
                </div>
                <div class="inventario-modal-group">
                    <label for="imagen">Imagen del Producto</label>
                    <input type="file" id="imagen" name="imagen" required>
                </div>
                <div class="inventario-modal-footer">
                    <button type="submit" class="inventario-btn inventario-btn-add">Guardar</button>
                    <button type="button" class="inventario-btn" data-close="modalAgregar">Cancelar</button>
                </div>
            </form>
        </div>
    </div>



    {% for p in productos %}
    <!-- Modal Editar Producto -->
    <div class="inventario-modal" id="ModalEdit{{ p['idProducto'] }}" style="display:none;">
        <div class="inventario-modal-backdrop" data-close="ModalEdit{{ p['idProducto'] }}"></div>
        <div class="inventario-modal-content">
            <div class="inventario-modal-header">
                <h4>Editar Producto: {{ p['nombre_producto'] }}</h4>
                <button type="button" class="inventario-modal-close" data-close="ModalEdit{{ p['idProducto'] }}">&times;</button>
            </div>
            <form action="{{ url_for('actualizarProducto', id=p['idProducto']) }}" method="POST" enctype="multipart/form-data" class="inventario-modal-form">
                <div class="inventario-modal-group">
                    <label for="nombre{{ p['idProducto'] }}">Nombre</label>
                    <input type="text" name="nombre" id="nombre{{ p['idProducto'] }}" value="{{ p['nombre_producto'] }}" required>
                </div>
                <div class="inventario-modal-group">
                    <label for="descripcion{{ p['idProducto'] }}">Descripción</label>
                    <input type="text" name="descripcion" id="descripcion{{ p['idProducto'] }}" value="{{ p['descripcion'] }}" required>
                </div>
                <div class="inventario-modal-group">
                    <label for="precio{{ p['idProducto'] }}">Precio</label>
                    <input type="number" name="precio" id="precio{{ p['idProducto'] }}" value="{{ p['precio'] }}" required>
                </div>
                <div class="inventario-modal-group">
                    <label for="cantidad{{ p['idProducto'] }}">Cantidad</label>
                    <input type="number" name="cantidad" id="cantidad{{ p['idProducto'] }}" value="{{ p['cantidad'] }}" required>
                </div>
                <div class="inventario-modal-group">
                    <label for="imagen{{ p['idProducto'] }}">Imagen</label>
                    <input type="file" name="imagen" id="imagen{{ p['idProducto'] }}">
                </div>
                <div class="inventario-modal-footer">
                    <button type="submit" class="inventario-btn inventario-btn-edit">Guardar Cambios</button>
                    <button type="button" class="inventario-btn inventario-btn-delete" data-close="ModalEdit{{ p['idProducto'] }}">Cerrar</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal Eliminar Producto -->
    <div class="inventario-modal" id="ModalEliminar{{ p['idProducto'] }}" style="display:none;">
        <div class="inventario-modal-backdrop" data-close="ModalEliminar{{ p['idProducto'] }}"></div>
        <div class="inventario-modal-content">
            <div class="inventario-modal-header">
                <h4>Confirmar Eliminación</h4>
                <button type="button" class="inventario-modal-close" data-close="ModalEliminar{{ p['idProducto'] }}">&times;</button>
            </div>
            <div class="inventario-modal-body">
                ¿Está seguro que desea eliminar el Producto: <strong>{{ p['nombre_producto'] }}</strong>?
            </div>
            <div class="inventario-modal-footer">
                <button type="button" class="inventario-btn" data-close="ModalEliminar{{ p['idProducto'] }}">Cancelar</button>
                <a href="{{ url_for('eliminarProducto', id=p['idProducto']) }}" class="inventario-btn inventario-btn-delete">Eliminar</a>
            </div>
        </div>
    </div>
    {% endfor %}




</div>
{% endblock %}